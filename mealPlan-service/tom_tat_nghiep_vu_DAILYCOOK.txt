=========================================================
TÃ“M Táº®T NGHIá»†P Vá»¤ Há»† THá»NG DAILYCOOK
(PhÃ¢n tÃ­ch tá»« Backend Code)
=========================================================

1. Tá»”NG QUAN Há»† THá»NG
====================

DAILYCOOK lÃ  má»™t á»©ng dá»¥ng mobile há»— trá»£ láº­p káº¿ hoáº¡ch bá»¯a Äƒn thÃ´ng minh vá»›i cÃ¡c tÃ­nh nÄƒng:
- Quáº£n lÃ½ nguyÃªn liá»‡u vÃ  mÃ³n Äƒn
- TÆ° váº¥n cháº¿ Ä‘á»™ dinh dÆ°á»¡ng cÃ¡ nhÃ¢n hÃ³a  
- Táº¡o thá»±c Ä‘Æ¡n tá»± Ä‘á»™ng dá»±a trÃªn AI
- Theo dÃµi vÃ  nháº¯c nhá»Ÿ uá»‘ng nÆ°á»›c
- Há»— trá»£ cáº£ cÃ¡ nhÃ¢n vÃ  gia Ä‘Ã¬nh

2. CÃC SERVICE CHÃNH
==================

A. USER-SERVICE (Quáº£n lÃ½ ngÆ°á»i dÃ¹ng)
-----------------------------------
CHá»¨C NÄ‚NG:
- Quáº£n lÃ½ thÃ´ng tin ngÆ°á»i dÃ¹ng (fullName, userImage)
- TÃ­ch há»£p vá»›i auth service Ä‘á»ƒ xÃ¡c thá»±c
- Admin cÃ³ thá»ƒ khÃ³a/má»Ÿ khÃ³a tÃ i khoáº£n
- Thá»‘ng kÃª tá»•ng sá»‘ ngÆ°á»i dÃ¹ng

NGHIá»†P Vá»¤:
- ÄÄƒng kÃ½ tá»± Ä‘á»™ng tá»« auth service
- PhÃ¢n quyá»n admin/user
- Theo dÃµi hoáº¡t Ä‘á»™ng ngÆ°á»i dÃ¹ng

B. INGREDIENT-SERVICE (Quáº£n lÃ½ nguyÃªn liá»‡u)
------------------------------------------
CHá»¨C NÄ‚NG:
- Quáº£n lÃ½ danh má»¥c nguyÃªn liá»‡u (IngredientCategory)
- Quáº£n lÃ½ nguyÃªn liá»‡u (Ingredient) vá»›i thÃ´ng tin dinh dÆ°á»¡ng chi tiáº¿t
- ÄÆ¡n vá»‹ Ä‘o lÆ°á»ng chuáº©n hÃ³a (MeasurementUnits)
- ThÃ´ng tin dinh dÆ°á»¡ng: calories, protein, carbs, fat

NGHIá»†P Vá»¤:
- Cung cáº¥p database nguyÃªn liá»‡u phong phÃº
- TÃ­nh toÃ¡n dinh dÆ°á»¡ng chÃ­nh xÃ¡c
- Há»— trá»£ nhiá»u Ä‘Æ¡n vá»‹ Ä‘o lÆ°á»ng
- PhÃ¢n loáº¡i nguyÃªn liá»‡u theo category

C. MEAL-SERVICE (Quáº£n lÃ½ mÃ³n Äƒn)
-------------------------------
CHá»¨C NÄ‚NG:
- Quáº£n lÃ½ danh má»¥c mÃ³n Äƒn (MealCategory: breakfast, lunch, dinner)
- Quáº£n lÃ½ cháº¿ Ä‘á»™ Äƒn uá»‘ng (DietType: normal, vegetarian, vegan, ketogenic, paleo)
- Quáº£n lÃ½ mÃ³n Äƒn vá»›i cÃ´ng thá»©c chi tiáº¿t
- TÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c cháº¿ Ä‘á»™ Äƒn khÃ¡c nhau
- Äá»™ phá»• biáº¿n cá»§a mÃ³n Äƒn (1-5 sao)

NGHIá»†P Vá»¤:
- Táº¡o database mÃ³n Äƒn Ä‘a dáº¡ng
- PhÃ¢n loáº¡i theo bá»¯a Äƒn vÃ  cháº¿ Ä‘á»™ dinh dÆ°á»¡ng
- TÃ­ch há»£p cÃ´ng thá»©c náº¥u Äƒn tá»« recipe-service
- Há»— trá»£ kháº©u pháº§n cho cÃ¡ nhÃ¢n/gia Ä‘Ã¬nh

D. SURVEY-SERVICE (Kháº£o sÃ¡t & Há»“ sÆ¡ cÃ¡ nhÃ¢n)
-------------------------------------------
CHá»¨C NÄ‚NG Cá»T LÃ•I:

1. ONBOARDING SYSTEM (CÃ¢u há»i cá»©ng):
   - Thu tháº­p thÃ´ng tin cÃ¡ nhÃ¢n: tuá»•i, giá»›i tÃ­nh, chiá»u cao, cÃ¢n náº·ng
   - PhÃ¢n loáº¡i: CÃ¡ nhÃ¢n vs Gia Ä‘Ã¬nh
   - ThÃ´ng tin gia Ä‘Ã¬nh: children, teenagers, adults, elderly
   - Sá»Ÿ thÃ­ch Äƒn uá»‘ng: loáº¡i cháº¿ Ä‘á»™ Äƒn, dá»‹ á»©ng, nguyÃªn liá»‡u khÃ´ng thÃ­ch
   - Má»¥c tiÃªu dinh dÆ°á»¡ng: calories/ngÃ y, tá»· lá»‡ protein/carbs/fat
   - CÃ i Ä‘áº·t nháº¯c nhá»Ÿ uá»‘ng nÆ°á»›c

2. SOFT SURVEYS (CÃ¢u há»i má»m):
   - CÃ¢u há»i kháº£o sÃ¡t linh hoáº¡t do admin táº¡o
   - Nhiá»u loáº¡i cÃ¢u há»i: text, select, radio, checkbox, rating
   - PhÃ¢n loáº¡i theo category
   - Admin cÃ³ thá»ƒ báº­t/táº¯t cÃ¢u há»i

NGHIá»†P Vá»¤:
- CÃ¡ nhÃ¢n hÃ³a tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng
- Thu tháº­p dá»¯ liá»‡u Ä‘á»ƒ AI recommendation
- Há»— trá»£ cáº£ há»™ gia Ä‘Ã¬nh vÃ  cÃ¡ nhÃ¢n
- Flexible survey system cho nghiÃªn cá»©u

E. MEALPLAN-SERVICE (Láº­p káº¿ hoáº¡ch thá»±c Ä‘Æ¡n - CORE)
------------------------------------------------
CHá»¨C NÄ‚NG HIá»†N Táº I:
- Táº¡o thá»±c Ä‘Æ¡n random tá»« database mÃ³n Äƒn
- LÆ°u trá»¯ thá»±c Ä‘Æ¡n theo ngÃ y
- Thay Ä‘á»•i/xÃ³a mÃ³n Äƒn trong thá»±c Ä‘Æ¡n
- Gá»£i Ã½ mÃ³n Äƒn tÆ°Æ¡ng tá»±
- Cache thá»±c Ä‘Æ¡n trong Redis
- Há»— trá»£ kháº©u pháº§n gia Ä‘Ã¬nh/cÃ¡ nhÃ¢n

CHá»¨C NÄ‚NG ÄANG PHÃT TRIá»‚N (AI):
- AI recommendation sá»­ dá»¥ng Gemini API
- Generate training data cho machine learning
- KNN model Ä‘á»ƒ gá»£i Ã½ dá»±a trÃªn user tÆ°Æ¡ng tá»±
- Hybrid approach: AI + Rule-based + ML

3. NGHIá»†P Vá»¤ CHI TIáº¾T THEO FLOW
==============================

A. FLOW ÄÄ‚NG KÃ & ONBOARDING
----------------------------
1. User Ä‘Äƒng kÃ½ tÃ i khoáº£n â†’ Auth service
2. Auth service gá»i User service táº¡o profile
3. User hoÃ n thÃ nh onboarding trong Survey service:
   - Chá»n loáº¡i há»“ sÆ¡: CÃ¡ nhÃ¢n/Gia Ä‘Ã¬nh
   - Nháº­p thÃ´ng tin cÆ¡ báº£n
   - Chá»n cháº¿ Ä‘á»™ Äƒn uá»‘ng, dá»‹ á»©ng
   - Äáº·t má»¥c tiÃªu dinh dÆ°á»¡ng
   - CÃ i Ä‘áº·t nháº¯c nhá»Ÿ uá»‘ng nÆ°á»›c
4. Survey service lÆ°u UserProfile vá»›i isOnboardingCompleted = true

B. FLOW Táº¡O THá»°C ÄÆ N
------------------
1. User request táº¡o thá»±c Ä‘Æ¡n cho má»™t ngÃ y
2. MealPlan service kiá»ƒm tra Redis cache
3. Náº¿u chÆ°a cÃ³, gá»i cÃ¡c service:
   - Survey service: láº¥y UserProfile (sá»Ÿ thÃ­ch, dá»‹ á»©ng, má»¥c tiÃªu dinh dÆ°á»¡ng)
   - Meal service: láº¥y danh sÃ¡ch mÃ³n Äƒn phÃ¹ há»£p
   - Ingredient service: láº¥y thÃ´ng tin dinh dÆ°á»¡ng
4. Táº¡o thá»±c Ä‘Æ¡n:
   - HIá»†N Táº I: Random selection vá»›i rule-based filtering
   - TÆ¯Æ NG LAI: AI recommendation vá»›i Gemini + KNN
5. LÆ°u vÃ o Redis vÃ  tráº£ vá» user

C. FLOW AI RECOMMENDATION (Äang phÃ¡t triá»ƒn)
------------------------------------------
1. PHASE 1: Data generation
   - DÃ¹ng Gemini AI táº¡o ~100+ user profiles giáº£
   - Generate meal selection history cho tá»«ng user
   - LÆ°u vÃ o TrainingDataModel

2. PHASE 2: KNN Training
   - Extract features tá»« user profile vÃ  meal data
   - Train KNN model vá»›i generated data
   - Feature vector: [age, gender, BMI, diet_type, calories_goal, ...]

3. PHASE 3: Hybrid Recommendation
   - KNN recommendation (náº¿u cÃ³ Ä‘á»§ confidence)
   - Fallback to Gemini API (real-time AI)
   - Ultimate fallback to rule-based

D. FLOW QUáº¢N LÃ DINH DÆ¯á» NG
-------------------------
1. Ingredient service cung cáº¥p thÃ´ng tin dinh dÆ°á»¡ng chuáº©n
2. Meal service tÃ­nh toÃ¡n dinh dÆ°á»¡ng tá»•ng cá»§a mÃ³n Äƒn
3. MealPlan service tÃ­nh toÃ¡n dinh dÆ°á»¡ng cá»§a cáº£ thá»±c Ä‘Æ¡n
4. So sÃ¡nh vá»›i má»¥c tiÃªu dinh dÆ°á»¡ng tá»« UserProfile
5. ÄÆ°a ra gá»£i Ã½ Ä‘iá»u chá»‰nh náº¿u cáº§n

4. CÃC TÃNH NÄ‚NG Äáº¶C BIá»†T
========================

A. Há»– TRá»¢ GIA ÄÃŒNH
-----------------
- PhÃ¢n biá»‡t cÃ¡ nhÃ¢n vs gia Ä‘Ã¬nh trong UserProfile
- TÃ­nh toÃ¡n kháº©u pháº§n cho nhiá»u thÃ nh viÃªn
- ThÃ´ng tin gia Ä‘Ã¬nh: sá»‘ tráº» em, thanh thiáº¿u niÃªn, ngÆ°á»i lá»›n, ngÆ°á»i cao tuá»•i
- CÃ¢n báº±ng dinh dÆ°á»¡ng cho cáº£ gia Ä‘Ã¬nh

B. TÃNH NÄ‚NG AI THÃ”NG MINH
-------------------------
- Há»c tá»« hÃ nh vi ngÆ°á»i dÃ¹ng
- Personalized recommendations
- TrÃ¡nh mÃ³n Äƒn dá»‹ á»©ng/khÃ´ng thÃ­ch
- CÃ¢n báº±ng dinh dÆ°á»¡ng tá»± Ä‘á»™ng
- Äa dáº¡ng hÃ³a thá»±c Ä‘Æ¡n

C. CHÄ‚M SÃ“C Sá»¨C KHá»E
-------------------
- Theo dÃµi má»¥c tiÃªu calories hÃ ng ngÃ y
- CÃ¢n báº±ng tá»· lá»‡ protein/carbs/fat
- Nháº¯c nhá»Ÿ uá»‘ng nÆ°á»›c
- Há»— trá»£ cÃ¡c cháº¿ Ä‘á»™ Äƒn Ä‘áº·c biá»‡t (keto, chay, ...)

5. KIáº¾N TRÃšC Há»† THá»NG
====================

A. MICROSERVICES ARCHITECTURE
-----------------------------
- User Service (Port 5001)
- Ingredient Service (Port 5000) 
- Meal Service (Port 5002)
- Survey Service (Port 5003)
- MealPlan Service (Port 5004)
- Recipe Service (External)
- Auth Service (External)

B. DATABASE
----------
- MongoDB cho má»—i service
- Redis cache cho performance
- Training data cho AI models

C. SECURITY
----------
- JWT authentication
- API key validation
- Admin role authorization
- Service-to-service authentication

6. ROADMAP PHÃT TRIá»‚N
===================

A. HIá»†N Táº I (V1.0)
-----------------
âœ… Basic meal planning vá»›i random selection
âœ… User onboarding system
âœ… Ingredient & meal management
âœ… Survey system
âœ… Redis caching

B. ÄANG PHÃT TRIá»‚N (V2.0)
------------------------
ğŸ”„ AI recommendation vá»›i Gemini API
ğŸ”„ KNN machine learning model
ğŸ”„ Training data generation
ğŸ”„ Hybrid recommendation system

C. TÆ¯Æ NG LAI (V3.0+)
------------------
â³ Advanced ML models (TensorFlow.js)
â³ Collaborative filtering
â³ Nutrition tracking
â³ Social features
â³ Recipe suggestions
â³ Grocery shopping integration

7. GIÃ TRá»Š NGHIá»†P Vá»¤
==================

A. CHO NGÆ¯á»œI DÃ™NG
----------------
- Tiáº¿t kiá»‡m thá»i gian láº­p káº¿ hoáº¡ch bá»¯a Äƒn
- Äáº£m báº£o dinh dÆ°á»¡ng cÃ¢n báº±ng
- Há»— trá»£ cháº¿ Ä‘á»™ Äƒn Ä‘áº·c biá»‡t
- TrÃ¡nh dá»‹ á»©ng thá»±c pháº©m
- Äa dáº¡ng hÃ³a bá»¯a Äƒn

B. CHO GIA ÄÃŒNH
--------------
- Láº­p thá»±c Ä‘Æ¡n cho cáº£ gia Ä‘Ã¬nh
- CÃ¢n nháº¯c nhu cáº§u dinh dÆ°á»¡ng theo Ä‘á»™ tuá»•i
- Tá»‘i Æ°u hÃ³a chi phÃ­ mua sáº¯m
- Giáº£m stress cho bÃ  máº¹

C. CHO CHUYÃŠN GIA DINH DÆ¯á» NG
---------------------------
- Thu tháº­p dá»¯ liá»‡u thÃ³i quen Äƒn uá»‘ng
- NghiÃªn cá»©u xu hÆ°á»›ng dinh dÆ°á»¡ng
- TÆ° váº¥n cÃ¡ nhÃ¢n hÃ³a
- A/B testing cÃ¡c approach khÃ¡c nhau

=========================================================
Káº¾T LUáº¬N:
DAILYCOOK lÃ  má»™t há»‡ thá»‘ng meal planning thÃ´ng minh, 
káº¿t há»£p AI vÃ  machine learning Ä‘á»ƒ cung cáº¥p gá»£i Ã½ 
thá»±c Ä‘Æ¡n cÃ¡ nhÃ¢n hÃ³a, há»— trá»£ cáº£ cÃ¡ nhÃ¢n vÃ  gia Ä‘Ã¬nh 
trong viá»‡c duy trÃ¬ cháº¿ Ä‘á»™ Äƒn uá»‘ng lÃ nh máº¡nh vÃ  cÃ¢n báº±ng.
=========================================================
